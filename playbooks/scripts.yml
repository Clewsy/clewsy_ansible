#Reversed the installer script at https://raw.githubusercontent.com/home-assistant/supervised-installer/master/installer.sh to develop this playbook and the docker-compose.yml

- name: Sync scripts.
  hosts: all
#  hosts: user_b4t
#  become: yes
  vars:
    base_url: https://gitlab.com/clewsy/scripts/-/raw/master/
    dest_dir: "/home/{{ ansible_user }}/bin/"
#    scripts:
#        - stuff.sh
#        - wami.sh

  tasks:

    - name: Sync scripts.
      get_url:
        url: "{{ base_url }}{{ item }}"
        dest: "{{ dest_dir }}{{ item }}"
        mode: +x
      with_items: "{{ scripts }}"

    - name: Customize stuff.sh colour theme 1 of 2 - comment default colour.
      lineinfile:
        path: "{{ dest_dir }}stuff.sh"
        regexp: "#Theme colour: CYAN"
        line: '#COL="\\\\033[00;36m"		#Theme colour: CYAN'  #Note escaped '/'s.
    - name: Customize stuff.sh colour theme 2 of 2 - set colour by host.
      lineinfile:
        path: "{{ dest_dir }}stuff.sh"
        regexp: "#Theme colour: {{ colour }}"
        line: 'COL="{{ colour_code }}"		#Theme colour: {{ colour }}'
