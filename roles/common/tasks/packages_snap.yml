---
- name: '[packages_snap] Install snapd.'
  apt:
    name: snapd
    state: latest
  notify: enable and start snapd
  when: packages.snap.install.0 is defined or packages.classic_snap.install.0 is defined

########### Installation of apps that don't come pre-installed.
- name: '[packages_snap] Install miscellaneous, host-specific snap packages.'
  snap:
    name: "{{ item }}"
    state: present
    classic: no
  when: packages.snap.install.0 is defined
  with_items: "{{ packages.snap.install }}"

- name: '[packages_snap] Install miscellaneous, host-specific classic snap packages.'
  snap:
    name: "{{ item }}"
    state: present
    classic: yes
  when: packages.classic_snaps.install.0 is defined
  with_items: "{{ packages.classic_snap.install }}"

########### Removal of apps that do come pre-installed.
- name: '[packages_snap] Remove miscellaneous, host-specific, pre-installed snap packages.'
  snap:
    name: "{{ item }}"
    state: absent
    classic: no
  when: packages.snaps.remove.0 is defined
  with_items: "{{ packages.snaps.remove }}"

- name: '[packages_snap] Remove miscellaneous, host-specific, pre-installed classic snap packages.'
  snap:
    name: "{{ item }}"
    state: absent
    classic: yes
  when: packages.classic_snaps.remove.0 is defined
  with_items: "{{ packages.classic_snaps.remove }}"
