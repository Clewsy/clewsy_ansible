---
- name: '[vlc] Load vlc variables.'
  include_vars: vlc_vars.yml

- name: '[vlc] Ensure flatpak is installed.'
  apt:
    name: flatpak
    state: latest

- name: '[vlc] Install vlc.'
  flatpak:
    name: https://dl.flathub.org/repo/appstream/org.videolan.VLC.flatpakref
    state: present
    method: system

- name: '[vlc] Create alias vlc for "flatpak run org.videolan.VLC".'
  lineinfile:
    path: "{{ ansible_user_home_dir }}/.bash_aliases"
    line: "alias vlc='flatpak run org.videolan.VLC'" 
    state: present


- name: "[vlc] Make vlc the default video player for {{ ansible_user }}."
  ini_file:
    path: "/home/{{ ansible_user }}/.config/mimeapps.list"
    section: "Default Applications"
    option: "{{ item }}"
    value: "vlc_vlc.desktop"
    no_extra_spaces: yes
    create: yes
    mode: '0600'
    owner: "{{ ansible_user }}"
    group: "{{ ansible_user }}"
  with_items: "{{ vlc_filetypes }}"
