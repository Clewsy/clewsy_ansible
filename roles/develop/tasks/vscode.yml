---
- name: '[vscode] Ensure flatpak is installed.'
  apt:
    name: flatpak
    state: latest

- name: '[vscode] Install vscode.'
  flatpak:
    name: https://dl.flathub.org/repo/appstream/com.visualstudio.code.flatpakref
    state: present
    method: system

- name: '[vscode] Ensure vscode user settings directory exists.'
  file:
    dest: "{{ ansible_user_home_dir }}/.config/Code/User"
    state: directory
    owner: "{{ ansible_user }}"
    group: "{{ ansible_user }}"
    mode: '0755'

- name: '[vscode] Copy vscode configuration file.'
  copy:
    src: "files/vscode/settings.json"
    dest: "{{ ansible_user_home_dir }}/.config/Code/User/settings.json"
    owner: "{{ ansible_user }}"
    group: "{{ ansible_user }}"
    mode: '0664'
