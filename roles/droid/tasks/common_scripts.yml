---
- name: '[common_scripts] Load common_scripts variables.'
  include_vars: common_scripts_vars.yml

- name: '[common_scripts] Ensure bin directory exists within user home directory.'
  file:
    dest: "{{ droid_home_dir }}/bin"
    state: directory
    mode: '0755'

###bu
- name: '[common_scripts] Copy bu script to user bin directory.'
  get_url:
    url: "{{ bu_script_url }}"
    dest: "{{ droid_home_dir }}/bin/bu"
    mode: '0755'

- name: '[common_scripts] Customize bu script to work with termux - relocate temp file.'
  lineinfile:
    path: "{{ droid_home_dir }}/bin/bu"
    regexp: '^TEMP_BU_FILE_LIST'
    line: 'TEMP_BU_FILE_LIST="/data/data/com.termux/files/home/bin/temp_bu_file_list"'

- name: '[common_scripts] Customize bu script to work with termux - correct hostname.'
  lineinfile:
    path: "{{ droid_home_dir }}/bin/bu"
    regexp: '^BU_REMOTE_DIR'
    line: 'BU_REMOTE_DIR="/home/$BU_USER/file_cache/flexo"'

- name: '[common_scripts] Create backup file list.'
  copy:
    content: "{{ backup_file_list }}"
    dest: "{{ droid_home_dir }}/bin/bu.list"
    mode: '0644'

###stuff
- name: '[common_scripts] Copy stuff script to user bin directory.'
  get_url:
    url: "{{ stuff_script_url }}"
    dest: "{{ droid_home_dir }}/bin/stuff"
    mode: '0755'

###wami
- name: '[common_scripts] Copy wami script to user bin directory.'
  get_url:
    url: "{{ wami_script_url }}"
    dest: "{{ droid_home_dir }}/bin/wami"
    mode: '0755'

###p0wer_switch.sh
- name: '[common_scripts] Copy p0wer_switch.sh script to user bin directory.'
  get_url:
    url: "{{ p0wer_switch_script_url }}"
    dest: "{{ droid_home_dir }}/bin/p0wer_switch.sh"
    mode: '0755'
