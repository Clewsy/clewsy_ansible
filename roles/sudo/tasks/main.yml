---
- name: Install sudo package.
  apt:
    name: sudo
    state: latest
    update_cache: yes

- name: Enable passwordless sudo.
  lineinfile:
    path: /etc/sudoers
    state: present
    regexp: '^%sudo'
    line: '%sudo ALL=(ALL) NOPASSWD: ALL'
    validate: 'visudo -cf %s'

- name: Add user to sudo group.
  user:
    name: "{{ ansible_user }}"
    groups: sudo
    append: yes