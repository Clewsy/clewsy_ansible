---
- name: Ensure all packages required for using ufw are installed.
  apt:
    name: "{{ ufw_packages }}"
    state: latest

- name: Enable ufw and set default policy to deny. #Note docker will poke holes through firewall for EXPOSEd ports.
  ufw:
    default: deny
    state: enabled
  notify: Restart ufw.

- name: Set allow rules. #Defined in defaults/main.yml if not defined elsewhere.
  ufw:
    rule: allow
    name: "{{ item }}"
  with_items: "{{ ufw_allows }}"
  notify: Restart ufw.